[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Spatial Data Modelling",
    "section": "",
    "text": "Welcome\nThis is the website for the course: “Spatial Data Modelling for Population Science using R”. The course was designed and is delivered by Professor Francisco Rowe from the Geographic Data Science Lab at the Department of Geography and Planning from the University of Liverpool, United Kingdom.\n\n\n\n\n\n\nNote\n\n\n\nA PDF version of this course is available for download here.\n\n\n\n\nContact\n\n\n\n\nFrancisco Rowe - fcorowe [at] liverpool.ac.uk - Professor in Population Data Science - Roxby Building, University of Liverpool - 74 Bedford St S, Liverpool, L69 7ZT, UK.",
    "crumbs": [
      "Welcome"
    ]
  },
  {
    "objectID": "01a_overview.html",
    "href": "01a_overview.html",
    "title": "Overview",
    "section": "",
    "text": "Aim\nThis course provides an introduction to Spatial Data Modelling for Population Science using R. It has been designed to be delivered in 15 hours of teaching, split into five sessions of 3 hours each, including breaks, practical examples and questions. This course provides an intuitive and practical explanation of methods, modelling frameworks and theories for analysing spatial data, as well as demographic and social processes represented in space. Spatial data have become ubiquitous. Data containing location have become increasingly common in both volume and frequency with the development and use of new sensor, satellite technilogy and GPS-based technologies, such as smartphones, social media platforms and contactless payment systems. At the same time, social and demographic processes occur within a geographic context that conditions or triggers their evolution. Therefore, these processes must be studied explicitly, considering the spatial context in which they take place. For these reasons, techniques that enable the analysis and modelling of spatial data are essential to understand demographic and social processes to inform policy and business decision-making.\nThe objective of the course is to expose students to a variety of techniques for the analysis and modelling of spatial data. The course discusses and illustrates the types of spatial data and the challenges they present, introducing a range of modelling and analytical approaches that explicitly account for space. It also aims to develop programming skills in the R language. These skills are important for several reasons: programming is in high demand, it teaches logical and methodical thinking, and it allows ideas to be materialised into tangible products such as maps. The course also aims to introduce generative artificial intelligence through the use of ChatGPT for code writing, debugging and reasoning.",
    "crumbs": [
      "Introduction",
      "Overview"
    ]
  },
  {
    "objectID": "01a_overview.html#learning-outcomes",
    "href": "01a_overview.html#learning-outcomes",
    "title": "Overview",
    "section": "Learning Outcomes",
    "text": "Learning Outcomes\nBy the end of the module, students should be able to:\n\nidentify some key sources of spatial data and resources of spatial analysis and modelling tools;\n\nexplain the advantages of taking spatial structure into account when analysing spatial data;\n\napply a range of computer-based techniques for the analysis of spatial data, including mapping, correlation, kernel density estimation, spatial interaction modelling and spatial econometrics;\n\napply appropriate analytical strategies to tackle the key methodological challenges facing spatial analysis – spatial autocorrelation, heterogeneity, and ecological fallacy; and,\n\nselect appropriate analytical tools for analysing specific spatial data sets to address emerging social issues facing the society.",
    "crumbs": [
      "Introduction",
      "Overview"
    ]
  },
  {
    "objectID": "01a_overview.html#teaching-approach",
    "href": "01a_overview.html#teaching-approach",
    "title": "Overview",
    "section": "Teaching Approach",
    "text": "Teaching Approach\nThe course combines lectures with a strong practical component and independent work. Each session will cover one of the following components:\n\nTypes of spatial data.\n\nManipulation and visualisation of spatial data.\n\nAnalysis of location data.\n\nAnalysis of spatial relationship data.\n\nModels that capture spatial correlation.\n\n\nThe course: - Introduces these techniques in an intuitive and applied manner rather than through theoretical mathematical or statistical derivations.\n\n\nFocuses on explaining when and why a technique is appropriate, followed by its application.\n\nUses several practical examples based on real data and research questions.\n\nIs built around the R programming language and uses structured computational notebooks compiled in a book, including code with explanations that can be reused with other datasets.",
    "crumbs": [
      "Introduction",
      "Overview"
    ]
  },
  {
    "objectID": "01b_environment.html",
    "href": "01b_environment.html",
    "title": "Environment",
    "section": "",
    "text": "To reproduce the code in the book, you need the following software packages:\n\nR version 4.5.1 (2025-06-13)\n\nRStudio Version 2025.09.1+401 (2025.09.1+401)\nQuarto 1.8.25\nthe list of libraries in the next section\n\nTo check your version of:\n\nR and libraries run sessionInfo()\nRStudio click help on the menu bar and then About\nQuarto check the version file in the quarto folder on your computer.\n\nTo install and update:\n\nR, download the appropriate version from The Comprehensive R Archive Network (CRAN)\nRStudio, download the appropriate version from Posit\nQuarto, download the appropriate version from the Quarto website\n\n\nDependency list\nThe list of libraries used in this book is provided below:\n\narm\ncar\ncorrplot\ndevtools\nFRK\ngghighlight\nggplot2\nggmap\nGISTools\ngridExtra\ngstat\nggthemes\nhexbin\njtools\nkableExtra\nknitr\nleaflet\nlme4\nlmtest\nlubridate\nmapdeck\nMASS\nmerTools\nplyr\npatchwork\nRColorBrewer\nrgdal\nscales\nsf\nsjPlot\nsp\nspgwr\nshowtext\nspatialreg\nspacetime\nstargazer\ntidyverse\ntmap\ntufte\nviridis\nbasemapR\n\nCopy, paste and run the code below in your console. Ensure all packages are installed on your computer.\n\n# package names\npackages &lt;- c(\n    \"arm\",\n    \"car\",\n    \"corrplot\",\n    \"devtools\",\n    \"FRK\",\n    \"gghighlight\",\n    \"ggplot2\",\n    \"ggmap\",\n    \"gridExtra\",\n    \"gstat\",\n    \"hexbin\",\n    \"jtools\",\n    \"kableExtra\",\n    \"knitr\",\n    \"lme4\",\n    \"lmtest\",\n    \"lubridate\",\n    \"MASS\",\n    \"merTools\",\n    \"plyr\",\n    \"RColorBrewer\",\n    \"sf\",\n    \"sjPlot\",\n    \"sp\",\n    \"spgwr\",\n    \"spatialreg\",\n    \"spacetime\",\n    \"stargazer\",\n    \"tidyverse\",\n    \"tmap\",\n    \"tufte\",\n    \"viridis\"\n)\n\n# install packages not yet installed\ninstalled_packages &lt;- packages %in% rownames(installed.packages())\nif (any(installed_packages == FALSE)) {\n  install.packages(packages[!installed_packages])\n}\n\n# packages loading\ninvisible(lapply(packages, library, character.only = TRUE))\n\n\n\n\n\n\n\n\n\n\n\nNote\n\n\n\nTo install the library basemapR, you need to install from source by running:\nlibrary(devtools) install_github('Chrisjb/basemapR')",
    "crumbs": [
      "Introduction",
      "Environment"
    ]
  },
  {
    "objectID": "01c_assessment.html",
    "href": "01c_assessment.html",
    "title": "Assessment",
    "section": "",
    "text": "Assignment 1: Spatial Data Infographic (40%)\nThe course assessment will consist of two components.\nDescription\nThe first assignment involves the creation of an infographic that visually communicates a spatial data story. The goal is to synthesise spatial data, analytical results and visual design into a clear, evidence-based narrative that can fit within a single PowerPoint slide. The infographic must demonstrate understanding of spatial concepts, analytical methods and effective data communication principles.\nInstructions\nEvaluation Criteria (100 points total)\nPurpose\nThis assignment develops skills in communicating spatial evidence succinctly and visually. This is an essential competence for academic, policy and professional audiences.",
    "crumbs": [
      "Introduction",
      "Assessment"
    ]
  },
  {
    "objectID": "01c_assessment.html#assignment-1-spatial-data-infographic-40",
    "href": "01c_assessment.html#assignment-1-spatial-data-infographic-40",
    "title": "Assessment",
    "section": "",
    "text": "Topic – Select a spatially explicit social, demographic or environmental issue (e.g., population change, internal migration, population decline, population ageing).\nData – Use the geospatial datasets on internal migration or population described in the Chapter dataset, or a comparable open dataset. Clearly cite all sources.\nContent – Present a concise spatial narrative integrating:\n\nA key research question or problem.\nRelevant spatial analysis or modelling results (maps, graphs and / or summary statistics).\nInterpretation of spatial patterns and implications.\nReferences or data sources.\n\nFormat –\n\nOne PowerPoint slide (16:9 ratio).\nAll text must be legible when projected on screen.\nInclude a clear title and author name.\nVisuals may include maps, charts, icons or minimal text boxes.\nUse consistent colour-blind friendly palette and typographic hierarchy.\n\nSubmission – Upload the PowerPoint (.pptx) file and a PDF version.\n\n\n\n\n\n\n\n\n\n\nCriterion\nDescription\nWeight\n\n\n\n\nRelevance and clarity of question\nDefines a meaningful spatial issue and communicates the core message clearly.\n20 %\n\n\nAnalytical rigor\nDemonstrates appropriate use of spatial data and analysis; accuracy of methods and results.\n25 %\n\n\nInterpretation\nInterprets spatial patterns logically and links findings to broader demographic or social processes.\n20 %\n\n\nDesign and visual communication\nEffective visual hierarchy, readability, layout, and use of colour; slide visually balanced and professional.\n25 %\n\n\nData and source transparency\nCorrect data citation and ethical use of sources.\n10 %",
    "crumbs": [
      "Introduction",
      "Assessment"
    ]
  },
  {
    "objectID": "01c_assessment.html#assignment-2-computational-essay-60",
    "href": "01c_assessment.html#assignment-2-computational-essay-60",
    "title": "Assessment",
    "section": "Assignment 2: Computational Essay (60%)",
    "text": "Assignment 2: Computational Essay (60%)\nDescription\nThe second assignment consists of a computational essay that integrates narrative, code and visualisation to explore a spatially explicit research question. A computational essay is a document in which the story, analysis and computation are woven together: The text explains the logic of the analysis, the code performs it, and the figures or tables present the results. This format reflects the way spatial data scientists communicate reproducible, evidence-based insights.\nObjectives\nThe computational essay should:\n\nDemonstrate the ability to apply spatial analysis or modelling techniques learned in the course.\nIntegrate theory, data and computation into a coherent narrative.\nPresent clear, reproducible and interpretable results using R.\nCommunicate findings effectively through maps, graphics and concise text.\n\n\nInstructions\n\nTopic Selection\nChoose a spatial problem relevant to the social, demographic, or environmental domains (e.g., population change, internal migration, population decline, population ageing). You may use the geospatial datasets on internal migration or population described in the Chapter dataset, or a comparable open dataset.\nStructure\n\nIntroduction (≈300–400 words): State the research question and explain its spatial relevance.\nData and Methods (≈400–600 words): Describe the data sources, spatial structure and analytical or modelling techniques used. Include annotated R code chunks performing the analysis.\nResults and Discussion (≈600–800 words): Present and interpret results using visualisations and tables. Discuss implications, limitations and potential extensions.\nConclusion (≈200–300 words): Summarise key findings and their significance.\nReferences (not included in the word count): Include all data and bibliographic sources using a consistent citation style.\n\nFormat and Submission\n\nMaximum 2,000 words (excluding code, references and captions).\nInclude R code directly within the essay in Quarto format.\nInclude up to five figures (a figure may contain multiple maps or plots if they form a single integrated result).\nInclude up to one table.\nSubmit both the rendered PDF or HTML output and the corresponding .qmd source file. Ensure the active the option self-contained in the YALM of the .qmd file. This ensures all figures are embedded within the final HTML file.\nAll analyses must be fully reproducible using the submitted code and data. Share data via a link to the platform where they are stored such as Google Drive, Dropbox or GitHub.\n\n\n\n\nEvaluation Criteria (100 points total)\n\n\n\n\n\n\n\n\nCriterion\nDescription\nWeight\n\n\n\n\nRelevance and research question\nClearly defined, spatially meaningful question grounded in theory or application.\n15%\n\n\nAnalytical rigor and reproducibility\nCorrect and appropriate use of spatial data and methods; code runs and reproduces results.\n25%\n\n\nIntegration of code and narrative\nNarrative, computation, and visuals are well-linked; code is readable and annotated.\n20%\n\n\nInterpretation and critical insight\nResults are interpreted thoughtfully, demonstrating understanding of spatial processes.\n20%\n\n\nPresentation and communication\nClarity of writing, structure, figure quality, and adherence to limits.\n15%\n\n\nTransparency and referencing\nComplete and accurate citation of data and literature sources.\n5%\n\n\n\n\nPurpose\nThis assignment develops core competencies in computational thinking, reproducible spatial analysis, and scientific communication. It trains students to present spatial data analyses as coherent narratives supported by transparent, executable code. This is a skill essential for modern population and spatial data science.",
    "crumbs": [
      "Introduction",
      "Assessment"
    ]
  },
  {
    "objectID": "02a_spatial-data.html",
    "href": "02a_spatial-data.html",
    "title": "1  Spatial Data",
    "section": "",
    "text": "1.1 Spatial Data types\nThis Chapter seeks to present and describe distinctive attributes of spatial data, and discuss some of the main challenges in analysing and modelling these data. Spatial data is a term used to describe any data associating a given variable attribute to a specific location on the Earth’s surface.\nDifferent classifications of spatial data types exist. Knowing the structure of the data at hand is important as specific analytical methods would be more appropriate for particular data types. We will use a particular classification involving four data types: lattice/areal data, point data, flow data and trajectory data (Fig. 1). This is not a exhaustive list but it is helpful to motivate the analytical and modelling methods that we cover in this book.\nLattice/Areal Data. These data correspond to records of attribute values (such as population counts) for a fixed geographical area. They may comprise regular shapes (such as grids or pixels) or irregular shapes (such as states, counties or travel-to-work areas). Raster data are a common source of regular lattice/areal area, while censuses are probably the most common form of irregular lattice/areal area. Point data within an area can be aggregated to produce lattice/areal data.\nPoint Data. These data refer to records of the geographic location of an discrete event, or the number of occurrences of geographical process at a given location. As displayed in Fig. 1, examples include the geographic location of bus stops in a city, or the number of boarding passengers at each bus stop.\nFlow Data. These data refer to records of measurements for a pair of geographic point locations. or pair of areas. These data capture the linkage or spatial interaction between two locations. Migration flows between a place of origin and a place of destination is an example of this type of data.\nTrajectory Data. These data record geographic locations of moving objects at various points in time. A trajectory is composed of a single string of data recording the geographic location of an object at various points in time and each record in the string contains a time stamp. These data are complex and can be classified into explicit trajectory data and implicit trajectory data. The former refer to well-structured data and record positions of objects continuously and intensively at uniform time intervals, such as GPS data. The latter is less structured and record data in relatively time point intervals, including sensor-based, network-based and signal-based data (Kong et al. 2018).\nIn this course, we cover analytical and modelling approaches for point, lattice/areal and flow data. While we do not explicitly analyse trajectory data, various of the analytical approaches described in this book can be extended to incorporate time, and can be applied to model these types of data. Rowe and Arribas-Bel (2022) provide an introduction on approaches to analyse and model spatio-temporal data. These same methods can be applied to trajectory data.",
    "crumbs": [
      "Content",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Spatial Data</span>"
    ]
  },
  {
    "objectID": "02a_spatial-data.html#spatial-data-types",
    "href": "02a_spatial-data.html#spatial-data-types",
    "title": "1  Spatial Data",
    "section": "",
    "text": "Fig. 1. Data Types. Area / Lattice data source: Önnerfors et al. (2019). Point data source: Tao et al. (2018). Flow data source: Rowe and Patias (2020). Trajectory data source: Kwan and Lee (2004).",
    "crumbs": [
      "Content",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Spatial Data</span>"
    ]
  },
  {
    "objectID": "02a_spatial-data.html#hierarchical-structure-of-data",
    "href": "02a_spatial-data.html#hierarchical-structure-of-data",
    "title": "1  Spatial Data",
    "section": "1.2 Hierarchical Structure of Data",
    "text": "1.2 Hierarchical Structure of Data\nThe hierarchical organisation is a key feature of spatial data. Smaller geographical units are organised within larger geographical units. You can find the hierarchical representation of UK Statistical Geographies on the Office for National Statistics website. In the bottom part of the output below, we can observe a spatial data frame for Liverpool displaying the hierarchical structure of census data (from the smallest to the largest): Output Areas (OAs), Lower Super Output Areas (LSOAs), Middle Super Output Areas (MSOAs) and Local Authority Districts (LADs). This hierarchical structure entails that units in smaller geographies are nested within units in larger geographies, and that smaller units can be aggregated to produce large units.\n\n\nSimple feature collection with 6 features and 4 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 335071.6 ymin: 389876.7 xmax: 339426.9 ymax: 394479\nProjected CRS: Transverse_Mercator\n      OA_CD   LSOA_CD   MSOA_CD    LAD_CD                       geometry\n1 E00176737 E01033761 E02006932 E08000012 MULTIPOLYGON (((335106.3 38...\n2 E00033515 E01006614 E02001358 E08000012 MULTIPOLYGON (((335810.5 39...\n3 E00033141 E01006546 E02001365 E08000012 MULTIPOLYGON (((336738 3931...\n4 E00176757 E01006646 E02001369 E08000012 MULTIPOLYGON (((335914.5 39...\n5 E00034050 E01006712 E02001375 E08000012 MULTIPOLYGON (((339325 3914...\n6 E00034280 E01006761 E02001366 E08000012 MULTIPOLYGON (((338198.1 39...\n\n\nNext we quickly go through the components of the output above. The first line indicates the type of feature and the number of rows (features) and columns (fields) in the data frame, except for the geometry. The second and third lines identify the type of geometry and dimension. The fourth line bbox stands for bounding box and display the min and max coordinates containing the Liverpool area in the data frame. The fifth line projected CRS indicates the coordinate reference system projection. If you would like to learn more about the various components of spatial data frames, please see the R sf package vignette on Simple Features.",
    "crumbs": [
      "Content",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Spatial Data</span>"
    ]
  },
  {
    "objectID": "02a_spatial-data.html#key-challenges",
    "href": "02a_spatial-data.html#key-challenges",
    "title": "1  Spatial Data",
    "section": "1.3 Key Challenges",
    "text": "1.3 Key Challenges\nMajor challenges exist when working with spatial data. Below we explore some of the key longstanding problems data scientists often face when working with geographical data.\n\n1.3.1 Modifible Area Unit Problem (MAUP)\nThe Modifible Area Unit Problem (MAUP) represents a challenge that has troubled geographers for decades (Openshaw 1981). Two aspects of the MAUP are normally recognised in empirical analysis relating to scale and zonation. Fig. 2 illustrates these issues\n\nScale refers to the idea that a geographical area can be divided into geographies with differing numbers of spatial units.\nZonation refers to the idea that a geographical area can be divided into the same number of units in a variety of ways.\n\n\n\n\nFig. 2. MAUP effect. (a) scale effect; and, (b) zonation effect. Source: Loidl et al. (2016).\n\n\nThe MAUP is a critical issue as it can impact our analysis and thus any conclusions we can infer from our results (e.g. Fotheringham and Wong 1991). There is no agreed systematic approach on how to handle the effects of the MAUP. Some have suggested to perform analyses based on different existing geographical scales, and assess the consistency of the results and identify potential sources of change. The issue with such approach is that results from analysis at different scales are likely to differ because distinct dimensions of a geographic process may be captured at different scales. For example, in migration studies, smaller geographies may be more suitable to capture residential mobility over short distances, while large geographies may be more suitable to capture long-distance migration. And it is well documented that these types of moves are driven by different factors. While residential mobility tends to be driven by housing related reasons, long-distance migration is more closely related to employment-related motives (Niedomysl 2011).\nAn alternative approach is to use the smallest geographical system available and create random aggregations at various geographical scales, to directly quantify the extent of scale and zonation. This approach has shown promising results in applications to study internal migration flows (Stillwell, Daras, and Bell 2018). Another approach involves the production of “meaningful” or functional geographies that can more appropriately capture the process of interest. There is an active area of work defining functional labour markets (Casado-Díaz, Martínez-Bernabéu, and Rowe 2017), urban areas (Arribas-Bel, Garcia-López, and Viladecans-Marsal 2021) and various forms of geodemographic classifications (Singleton and Spielman 2013; Patias, Rowe, and Cavazzi 2019) . However there is the recognition that none of the existing approaches resolve the effects of the MAUP and recently it has been suggested that the most plausible ‘solution’ would be to ignore the MAUP (Wolf et al. 2020).\n\n\n1.3.2 Ecological Fallacy\nEcological fallacy is an error in the interpretation of statistical data based on aggregate information. Specifically it refers to inferences made about the nature of specific individuals based solely on statistics aggregated for a given group. It is about thinking that relationships observed for groups necessarily hold for individuals. A key example is Robinson (1950) who illustrates this problem exploring the difference between ecological correlations and individual correlations. He looked at the relationship between country of birth and literacy. Robinson (1950) used the percent of foreign-born population and percent of literate population for the 48 states in the United States in 1930. The ecological correlation based on these data was 0.53. This suggests a positive association between foreign birth and literacy, and could be interpreted as foreign born individuals being more likely to be literate than native-born individuals. Yet, the correlation based on individual data was negative -0.11 which indicates the opposite. The main point emerging from this example is to carefully interpret analysis based on spatial data and avoid making inferences about individuals from these data.\n\n\n1.3.3 Spatial Dependence\nSpatial dependence refers to the spatial relationship of a variable’s values for a pair of locations at a certain distance apart, so that these values are more similar (or less similar) than expected for randomly associated pairs of observations (Anselin 1988). For example, we could think of observed patterns of ethnic segregation in an area are a result of spillover effects of pre-existing patterns of ethnic segregation in neighbouring areas. Chapter 5 will illustrate approach to explicitly incorporate spatial dependence in regression analysis.\n\n\n1.3.4 Spatial Heterogeneity\nSpatial heterogeneity refers to the uneven distribution of a variable’s values across space. Concentration of deprivation or unemployment across an area are good examples of spatial heterogeneity. We illustrate various ways to visualise, explore and measure the spatial distribution of data in multiple chapters. We also discuss on how to use spatial econometrics to capture spatial heterogeneity in Chapter 4 and Chapter 5.\n\n\n1.3.5 Spatial nonstationarity\nSpatial nonstationarity refers to variations in the relationship between an outcome variable and a set of predictor variables across space. In a modelling context, it relates to a situation in which a simple “global” model is inappropriate to explain the relationships between a set of variables. The geographical nature of the model must be modified to reflect local structural relationships within the data. For example, ethinic segregation has been positively associated with employment outcomes in some countries pointing to networks in pre-existing communities facilitating access to the local labour market. Inversely ethnic segregation has been negatively associated with employment outcomes pointing to lack of integration into the broader local community. We do not cover modelling approaches for this issue. Interested readers could refer to Rowe and Arribas-Bel (2022).\n\n\n\n\nAnselin, Luc. 1988. Spatial Econometrics: Methods and Models. Vol. 4. Springer Science & Business Media.\n\n\nArribas-Bel, Daniel, M.-À. Garcia-López, and Elisabet Viladecans-Marsal. 2021. “Building(s and) Cities: Delineating Urban Areas with a Machine Learning Algorithm.” Journal of Urban Economics 125 (September): 103217. https://doi.org/10.1016/j.jue.2019.103217.\n\n\nCasado-Díaz, José Manuel, Lucas Martínez-Bernabéu, and Francisco Rowe. 2017. “An Evolutionary Approach to the Delimitation of Labour Market Areas: An Empirical Application for Chile.” Spatial Economic Analysis 12 (4): 379–403. https://doi.org/10.1080/17421772.2017.1273541.\n\n\nFotheringham, A Stewart, and David WS Wong. 1991. “The Modifiable Areal Unit Problem in Multivariate Statistical Analysis.” Environment and Planning A 23 (7): 1025–44.\n\n\nKong, Xiangjie, Menglin Li, Kai Ma, Kaiqi Tian, Mengyuan Wang, Zhaolong Ning, and Feng Xia. 2018. “Big Trajectory Data: A Survey of Applications and Services.” IEEE Access 6: 58295–306. https://doi.org/10.1109/access.2018.2873779.\n\n\nKwan, Mei-Po, and Jiyeong Lee. 2004. “Geovisualization of Human Activity Patterns Using 3D GIS: A Time-Geographic Approach.” Spatially Integrated Social Science 27: 721–44.\n\n\nLoidl, Martin, Gudrun Wallentin, Robin Wendel, and Bernhard Zagel. 2016. “Mapping Bicycle Crash Risk Patterns on the Local Scale.” Safety 2 (3): 17. https://doi.org/10.3390/safety2030017.\n\n\nNiedomysl, Thomas. 2011. “How Migration Motives Change over Migration Distance: Evidence on Variation Across Socio-Economic and Demographic Groups.” Regional Studies 45 (6): 843–55. https://doi.org/10.1080/00343401003614266.\n\n\nÖnnerfors, Åsa, Mariana Kotzeva, Teodóra Brandmüller, et al. 2019. “Eurostat Regional Yearbook 2019 Edition.”\n\n\nOpenshaw, Stan. 1981. “The Modifiable Areal Unit Problem.” Quantitative Geography: A British View, 60–69.\n\n\nPatias, Nikos, Francisco Rowe, and Stefano Cavazzi. 2019. “A Scalable Analytical Framework for Spatio-Temporal Analysis of Neighborhood Change: A Sequence Analysis Approach.” In, 223–41. Springer International Publishing. https://doi.org/10.1007/978-3-030-14745-7_13.\n\n\nRobinson, WS. 1950. “Ecological Correlations and Individual Behavior.” American Sociological Review 15 (195): 351–57.\n\n\nRowe, Francisco, and Dani Arribas-Bel. 2022. “Spatial Modelling for Data Scientists.” University of Liverpool.\n\n\nRowe, Francisco, and Nikos Patias. 2020. “Mapping the Spatial Patterns of Internal Migration in Europe.” Regional Studies, Regional Science 7 (1): 390–93. https://doi.org/10.1080/21681376.2020.1811139.\n\n\nSingleton, Alexander D., and Seth E. Spielman. 2013. “The Past, Present, and Future of Geodemographic Research in the United States and United Kingdom.” The Professional Geographer 66 (4): 558–67. https://doi.org/10.1080/00330124.2013.848764.\n\n\nStillwell, John, Konstantinos Daras, and Martin Bell. 2018. “Spatial Aggregation Methods for Investigating the MAUP Effects in Migration Analysis.” Applied Spatial Analysis and Policy 11 (4): 693–711. https://doi.org/10.1007/s12061-018-9274-6.\n\n\nTao, Sui, Jonathan Corcoran, Francisco Rowe, and Mark Hickman. 2018. “To Travel or Not to Travel: ‘Weather’ Is the Question. Modelling the Effect of Local Weather Conditions on Bus Ridership.” Transportation Research Part C: Emerging Technologies 86 (January): 147–67. https://doi.org/10.1016/j.trc.2017.11.005.\n\n\nWolf, Levi John, Sean Fox, Rich Harris, Ron Johnston, Kelvyn Jones, David Manley, Emmanouil Tranos, and Wenfei Winnie Wang. 2020. “Quantitative Geography III: Future Challenges and Challenging Futures.” Progress in Human Geography 45 (3): 596–608. https://doi.org/10.1177/0309132520924722.",
    "crumbs": [
      "Content",
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Spatial Data</span>"
    ]
  },
  {
    "objectID": "02b_geomanipulation.html",
    "href": "02b_geomanipulation.html",
    "title": "2  Spatial data manipulation and visualisation",
    "section": "",
    "text": "2.1 Dependencies\nThis Chapter aims to demonstrate how we can manipulate, wrangle and visualise spatial data in R.\nWe ensure to load the libraries below. A core area of this session is learning to work with spatial data in R. R offers an ecosystem of purposely designed packages for manipulation and visualisation of spatial data and spatial analysis techniques. These ecosystem is known a r-spatial. Various packages exist in CRAN (The Comprehensive R Archive Network), including sf (E. Pebesma 2018, 2022a), stars (E. Pebesma 2022b), terra, s2 (Dunnington, Pebesma, and Rubak 2023), lwgeom (E. Pebesma 2023), gstat (E. J. Pebesma 2004; E. Pebesma and Graeler 2022), spdep (Bivand 2022), spatialreg (Bivand and Piras 2022), spatstat (Baddeley, Rubak, and Turner 2015; Baddeley, Turner, and Rubak 2022), tmap (Tennekes 2018, 2022), mapview (Appelhans et al. 2022) and more. A key package is this ecosystem is sf (E. Pebesma and Bivand 2023). R package sf provides a table format for simple features, where feature geometries are stored in a list-column. It appears in 2016 and was developed to move spatial data analysis in R closer to standards-based approaches seen in the industry and open source projects, to build upon more modern versions of open source geospatial software stack and allow for integration of R spatial software with the tidyverse (Wickham et al. 2019), particularly ggplot2, dplyr, and tidyr. In this course, we will heavily use sf.\n# data wrangling\nlibrary(tidyverse)\n\n# spatial data wrangling\nlibrary(sf)\nlibrary(sp) \n\n# data visualisation\nlibrary(viridis) \nlibrary(RColorBrewer) \n\n# format data visualisations\nlibrary(ggthemes)\nlibrary(patchwork)\nlibrary(showtext)\nlibrary(scales)\n\n# create maps\nlibrary(leaflet)\nlibrary(tmap)\nlibrary(mapdeck)",
    "crumbs": [
      "Content",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Spatial data manipulation and visualisation</span>"
    ]
  },
  {
    "objectID": "02b_geomanipulation.html#footnotes",
    "href": "02b_geomanipulation.html#footnotes",
    "title": "2  Spatial data manipulation and visualisation",
    "section": "",
    "text": "You can install package mypackage by running the command install.packages(\"mypackage\") on the R prompt or through the Tools --&gt; Install Packages... menu in RStudio.↩︎",
    "crumbs": [
      "Content",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Spatial data manipulation and visualisation</span>"
    ]
  },
  {
    "objectID": "02b_geomanipulation.html#dependencies",
    "href": "02b_geomanipulation.html#dependencies",
    "title": "2  Spatial data manipulation and visualisation",
    "section": "",
    "text": "Appelhans, Tim, Florian Detsch, Christoph Reudenbach, and Stefan Woellauer. 2022. Mapview: Interactive Viewing of Spatial Data in r. https://github.com/r-spatial/mapview.\n\n\nBaddeley, Adrian, Ege Rubak, and Rolf Turner. 2015. Spatial Point Patterns: Methodology and Applications with r. CRC press.\n\n\nBaddeley, Adrian, Rolf Turner, and Ege Rubak. 2022. Spatstat: Spatial Point Pattern Analysis, Model-Fitting, Simulation, Tests. http://spatstat.org/.\n\n\nBivand, Roger. 2022. Spdep: Spatial Dependence: Weighting Schemes, Statistics.\n\n\nBivand, Roger, and Gianfranco Piras. 2022. Spatialreg: Spatial Regression Analysis. https://CRAN.R-project.org/package=spatialreg.\n\n\nDunnington, Dewey, Edzer Pebesma, and Ege Rubak. 2023. S2: Spherical Geometry Operators Using the S2 Geometry Library. https://CRAN.R-project.org/package=s2.\n\n\nPebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” The R Journal 10 (1): 439–46. https://doi.org/10.32614/RJ-2018-009.\n\n\n———. 2022a. Sf: Simple Features for r. https://CRAN.R-project.org/package=sf.\n\n\n———. 2022b. Stars: Spatiotemporal Arrays, Raster and Vector Data Cubes. https://CRAN.R-project.org/package=stars.\n\n\n———. 2023. Lwgeom: Bindings to Selected Liblwgeom Functions for Simple Features. https://github.com/r-spatial/lwgeom/.\n\n\nPebesma, Edzer J. 2004. “Multivariable Geostatistics in S: The Gstat Package.” Computers & Geosciences 30 (7): 683–91. https://doi.org/10.1016/j.cageo.2004.03.012.\n\n\nPebesma, Edzer, and Roger Bivand. 2023. Spatial Data Science: With Applications in r. CRC Press.\n\n\nPebesma, Edzer, and Benedikt Graeler. 2022. Gstat: Spatial and Spatio-Temporal Geostatistical Modelling, Prediction and Simulation. https://github.com/r-spatial/gstat/.\n\n\nTennekes, Martijn. 2018. “tmap: Thematic Maps in R.” Journal of Statistical Software 84 (6): 1–39. https://doi.org/10.18637/jss.v084.i06.\n\n\n———. 2022. Tmap: Thematic Maps. https://github.com/r-tmap/tmap.\n\n\nWickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. “Welcome to the tidyverse.” Journal of Open Source Software 4 (43): 1686. https://doi.org/10.21105/joss.01686.",
    "crumbs": [
      "Content",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Spatial data manipulation and visualisation</span>"
    ]
  },
  {
    "objectID": "02b_geomanipulation.html#data",
    "href": "02b_geomanipulation.html#data",
    "title": "2  Spatial data manipulation and visualisation",
    "section": "2.2 Data",
    "text": "2.2 Data\nHere we read all the data needed for the analysis. We use two types of data: (1) human mobility derived from Meta-Facebook users; and, (2) administrative boundary data for Chile.\n\n2.2.1 Meta-Facebook mobility data\nWe use origin-destination mobility flow data between Provinces in Chile. We use data for April 2020. For a detailed description of the Meta-Facebook mobility data, please see the introductory session for the followwing workshop “Using Digital Footprint Data to Measure and Monitor Human Mobility”. We start by reading the data. We filter only flows occurring within the boundaries of Chile. The dataset contains daily flow counts between provinces that occurred in April 2020 during three windows of time during the day; that is, between 12am, 8am and 4pm.\nWe have a look at the data frame. We can see that the data contains 20 columns and 29,491 origin-destination interactions capturing counts of movements between provinces.\n\n\n\n\nAppelhans, Tim, Florian Detsch, Christoph Reudenbach, and Stefan Woellauer. 2022. Mapview: Interactive Viewing of Spatial Data in r. https://github.com/r-spatial/mapview.\n\n\nBaddeley, Adrian, Ege Rubak, and Rolf Turner. 2015. Spatial Point Patterns: Methodology and Applications with r. CRC press.\n\n\nBaddeley, Adrian, Rolf Turner, and Ege Rubak. 2022. Spatstat: Spatial Point Pattern Analysis, Model-Fitting, Simulation, Tests. http://spatstat.org/.\n\n\nBivand, Roger. 2022. Spdep: Spatial Dependence: Weighting Schemes, Statistics.\n\n\nBivand, Roger, and Gianfranco Piras. 2022. Spatialreg: Spatial Regression Analysis. https://CRAN.R-project.org/package=spatialreg.\n\n\nDunnington, Dewey, Edzer Pebesma, and Ege Rubak. 2023. S2: Spherical Geometry Operators Using the S2 Geometry Library. https://CRAN.R-project.org/package=s2.\n\n\nPebesma, Edzer. 2018. “Simple Features for R: Standardized Support for Spatial Vector Data.” The R Journal 10 (1): 439–46. https://doi.org/10.32614/RJ-2018-009.\n\n\n———. 2022a. Sf: Simple Features for r. https://CRAN.R-project.org/package=sf.\n\n\n———. 2022b. Stars: Spatiotemporal Arrays, Raster and Vector Data Cubes. https://CRAN.R-project.org/package=stars.\n\n\n———. 2023. Lwgeom: Bindings to Selected Liblwgeom Functions for Simple Features. https://github.com/r-spatial/lwgeom/.\n\n\nPebesma, Edzer J. 2004. “Multivariable Geostatistics in S: The Gstat Package.” Computers & Geosciences 30 (7): 683–91. https://doi.org/10.1016/j.cageo.2004.03.012.\n\n\nPebesma, Edzer, and Roger Bivand. 2023. Spatial Data Science: With Applications in r. CRC Press.\n\n\nPebesma, Edzer, and Benedikt Graeler. 2022. Gstat: Spatial and Spatio-Temporal Geostatistical Modelling, Prediction and Simulation. https://github.com/r-spatial/gstat/.\n\n\nTennekes, Martijn. 2018. “tmap: Thematic Maps in R.” Journal of Statistical Software 84 (6): 1–39. https://doi.org/10.18637/jss.v084.i06.\n\n\n———. 2022. Tmap: Thematic Maps. https://github.com/r-tmap/tmap.\n\n\nWickham, Hadley, Mara Averick, Jennifer Bryan, Winston Chang, Lucy D’Agostino McGowan, Romain François, Garrett Grolemund, et al. 2019. “Welcome to the tidyverse.” Journal of Open Source Software 4 (43): 1686. https://doi.org/10.21105/joss.01686.",
    "crumbs": [
      "Content",
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Spatial data manipulation and visualisation</span>"
    ]
  }
]